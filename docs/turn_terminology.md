# Turn Terminology

This project uses two different runtime concepts that previously both used the word "turn":

1. `turnId` (conversation/memory turn)
- Scope: one user-originated interaction cycle.
- Source: generated by `MemoryManager.startTurn()` and stored in `AgentRuntimeState.activeTurnId`.
- Usage: tags memory traces (`user`, `tool_call`, `tool_result`, `assistant`) so compaction/retrieval can group by conversation turn.

2. `ToolInvocationBatch` (tool aggregation batch)
- Scope: one set of tool calls emitted by a single LLM response.
- Source: created in `LLMUserMessageReadyEventHandler` when tool invocations are parsed from streamed output.
- Usage: temporarily collects tool results and gates when to enqueue one aggregated tool-results message back into the input pipeline.

## Relationship

- One conversation turn (`turnId`) can contain zero, one, or multiple `ToolInvocationBatch` instances.
- `turnId` is durable memory identity.
- `ToolInvocationBatch` is short-lived orchestration state.

## Cross-repo note

- `autobyteus-server` and `autobyteus-web` only expose the memory trace turn (`turn_id` / `turnId`) in memory view APIs.
- They do not currently expose the transient tool aggregation batch state.
